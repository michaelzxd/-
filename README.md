# 利用编程实现办公自动化的探索与心得

在办公室工作中，经常会有大量的表格统计更新、数据转移（例如从Excel转至Word）以及系统录入等重复性工作，而它们往往会占用大量时间且容易出错。笔者一直在思考和探索利用编程实现办公自动化的方法，通过自学Visual Basic和Python并实际应用，取得了不错的效果，重复性工作占用的时间比以往缩减50%以上，大幅度解放了双手，提高了工作效率。在此分享一些心得，供大家参考。

一、Excel和Word操作（适用Office自带的VB语言）

（一）单独Excel表用函数即可
以笔者经验，一般来讲，如果只有单独一个Excel文件，通过内部工作薄（即Worksheets）之间相互引用，再加上Excel丰富的函数库即可解决90%以上的需求。如果有更多需求，可通过自定义函数来处理。

（二）多张Excel表需用VB语言编写宏 
如果有多张Excel表（里面可包括多个工作薄）需要同时更新或操作，可单独新建一个Excel文件来放置宏，并通过该文件来操作其他文件，该文件就类似控制面板。面板上每一个按钮都链接到一个宏，通过一张表即可同时对同一文件夹下的6张表进行解密打开、更新数值、切换日期、保存等操作。VB编程入门快易上手，短时间内学会基本语法就能够尝试自己编写代码（推荐的入门参考书籍在文末，根据书上指引，零基础短时间内即可入门）。

（三）VB语言实现Excel到Word的数据转移
以往根据Excel里的数写一个Word文档，都是从Excel逐一复制粘贴到Word，如果数据很多且分散在不同工作薄，则很容易出错。VB是Office内嵌语言，对Excel和Word均有效用，难点在于如何在Excel中启动Word程序。笔者做了大量查询和验证，终于找到正确且稳定的方法，通过以下三行代码即可解决问题。
    
    Set doc = CreateObject("Word.application")
    
    Set wd = doc.Documents.Add
    
    doc.Visible = True
 
 有了这三行代码，剩下的就是取值写入的问题了。笔者写的程序通过Excel自动生成请款签报，运行结果稳定、迅速、无差错，获得同事们的高度好评。


二、系统数据录入等操作（需使用Python）
如果是Office之外的自动化操作，则需要用到Python。Python入门也较为简单，且标准库和第三方库众多，功能十分强大，是全球最受欢迎的编程语言之一。笔者所写的自动发邮件、PDF处理程序等都是用Python编写的。这里以系统数据录入为例给大家介绍Python的应用。人工把数据录入系统一直是一项耗费时间长且容易出错的工作，笔者一直在思考如何自动化这项工作，半年之久都没有结果，直到偶然发现了一个神奇的Python模块——Pyautogui。模块文档在此：    
https://pyautogui.readthedocs.io/en/latest/

Pyautogui相当于一个虚拟机械手，可实现鼠标移动、点击和键盘输入的所有操作，基本原理是通过图片定位鼠标位置，再进行点击或键盘输入。当时应用中遇到的最大困难是，屏幕分辨率即使有很细微的变化，图片定位也会失败，网络上有很多人也遇到同样的问题但并没有找到解决办法，程序编写一度遇到困境。后来反复研读模块文档，终于发现，套用center函数和LocateOnScreen函数自定义一个新函数即可调用置信区间参数来巧妙解决这个问题，一切迎刃而解，后续的编写也水到渠成。该程序代码接近1000行，实际应用时效率奇高，代码如下：

https://github.com/michaelzxd/AutoNC-pyautogui


三、学习资料推荐 

（一）学习VB推荐书籍——《别怕，EXCEL VBA其实很简单》

（二）学习Python推荐书籍——《自学是门手艺》，作者：李笑来，网上公开版：

https://github.com/selfteaching/the-craft-of-selfteaching/blob/master/README.md

（三）搜索引擎。关于编程95%的问题都可以通过搜索引擎找到答案。
